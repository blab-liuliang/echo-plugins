
//  (C) Copyright Edward Diener 2011-2015
//  Use, modification and distribution are subject to the Boost Software License,
//  Version 1.0. (See accompanying file LICENSE_1_0.txt or copy at
//  http://www.boost.org/LICENSE_1_0.txt).

#if !defined(HBOOST_VMD_DETAIL_IS_ARRAY_COMMON_HPP)
#define HBOOST_VMD_DETAIL_IS_ARRAY_COMMON_HPP

#include <hboost/preprocessor/cat.hpp>
#include <hboost/preprocessor/comparison/equal.hpp>
#include <hboost/preprocessor/control/if.hpp>
#include <hboost/preprocessor/control/iif.hpp>
#include <hboost/preprocessor/facilities/empty.hpp>
#include <hboost/preprocessor/tuple/elem.hpp>
#include <hboost/preprocessor/tuple/size.hpp>
#include <hboost/vmd/identity.hpp>
#include <hboost/vmd/is_empty.hpp>
#include <hboost/vmd/is_number.hpp>
#include <hboost/vmd/is_tuple.hpp>
#include <hboost/vmd/detail/is_empty_tuple.hpp>

#define HBOOST_VMD_DETAIL_IS_ARRAY_SYNTAX(tuple) \
    HBOOST_VMD_IDENTITY_RESULT \
        ( \
        HBOOST_PP_IIF \
            ( \
            HBOOST_PP_EQUAL(2,HBOOST_PP_TUPLE_SIZE(tuple)), \
            HBOOST_VMD_DETAIL_IS_ARRAY_CHECK_ARRAY_FORM, \
            HBOOST_VMD_IDENTITY(0) \
            ) \
        (tuple) \
        ) \
/**/

#define HBOOST_VMD_DETAIL_IS_ARRAY_SYNTAX_D(d,tuple) \
    HBOOST_VMD_IDENTITY_RESULT \
        ( \
        HBOOST_PP_IIF \
            ( \
            HBOOST_PP_EQUAL_D(d,2,HBOOST_PP_TUPLE_SIZE(tuple)), \
            HBOOST_VMD_DETAIL_IS_ARRAY_CHECK_ARRAY_FORM_D, \
            HBOOST_VMD_IDENTITY(0) \
            ) \
        (d,tuple) \
        ) \
/**/

/*

  Check if the first element of the tuple is equal to the number of tuple elements of the second element

*/

#define HBOOST_VMD_DETAIL_IS_ARRAY_CHECK_NUMERIC_MATCH_SIZE(x) \
    HBOOST_PP_EQUAL(HBOOST_PP_TUPLE_ELEM(0,x),HBOOST_PP_TUPLE_SIZE(HBOOST_PP_TUPLE_ELEM(1,x))) \
/**/

#define HBOOST_VMD_DETAIL_IS_ARRAY_CHECK_NUMERIC_MATCH_SIZE_D(d,x) \
    HBOOST_PP_EQUAL_D(d,HBOOST_PP_TUPLE_ELEM(0,x),HBOOST_PP_TUPLE_SIZE(HBOOST_PP_TUPLE_ELEM(1,x))) \
/**/

#define HBOOST_VMD_DETAIL_IS_ARRAY_CHECK_EMPTY(tuple) \
    HBOOST_VMD_DETAIL_IS_EMPTY_TUPLE_SIZE(HBOOST_PP_TUPLE_ELEM(1,tuple)) \
/**/

#define HBOOST_VMD_DETAIL_IS_ARRAY_CHECK_EMPTY_D(d,tuple) \
    HBOOST_VMD_DETAIL_IS_EMPTY_TUPLE_SIZE(HBOOST_PP_TUPLE_ELEM(1,tuple)) \
/**/

#define HBOOST_VMD_DETAIL_IS_ARRAY_CHECK_NUMERIC_MATCH(tuple) \
    HBOOST_PP_IF \
        ( \
        HBOOST_PP_TUPLE_ELEM(0,tuple), \
        HBOOST_VMD_DETAIL_IS_ARRAY_CHECK_NUMERIC_MATCH_SIZE, \
        HBOOST_VMD_DETAIL_IS_ARRAY_CHECK_EMPTY \
        ) \
    (tuple) \
/**/

#define HBOOST_VMD_DETAIL_IS_ARRAY_CHECK_NUMERIC_MATCH_D(d,tuple) \
    HBOOST_PP_IF \
        ( \
        HBOOST_PP_TUPLE_ELEM(0,tuple), \
        HBOOST_VMD_DETAIL_IS_ARRAY_CHECK_NUMERIC_MATCH_SIZE_D, \
        HBOOST_VMD_DETAIL_IS_ARRAY_CHECK_EMPTY_D \
        ) \
    (d,tuple) \
/**/

/*

  Check if the first element is numeric

*/

#define HBOOST_VMD_DETAIL_IS_ARRAY_CHECK_NUMERIC(tuple) \
    HBOOST_VMD_IDENTITY_RESULT \
        ( \
        HBOOST_PP_IIF \
          ( \
          HBOOST_VMD_DETAIL_IS_ARRAY_NUM(HBOOST_PP_TUPLE_ELEM(0,tuple)), \
          HBOOST_VMD_DETAIL_IS_ARRAY_CHECK_NUMERIC_MATCH, \
          HBOOST_VMD_IDENTITY(0) \
          ) \
        (tuple) \
        ) \
/**/

#define HBOOST_VMD_DETAIL_IS_ARRAY_CHECK_NUMERIC_D(d,tuple) \
    HBOOST_VMD_IDENTITY_RESULT \
        ( \
        HBOOST_PP_IIF \
          ( \
          HBOOST_VMD_DETAIL_IS_ARRAY_NUM(HBOOST_PP_TUPLE_ELEM(0,tuple)), \
          HBOOST_VMD_DETAIL_IS_ARRAY_CHECK_NUMERIC_MATCH_D, \
          HBOOST_VMD_IDENTITY(0) \
          ) \
        (d,tuple) \
        ) \
/**/

#define HBOOST_VMD_DETAIL_IS_ARRAY_CHECK_NUMBER(tuple) \
    HBOOST_VMD_IDENTITY_RESULT \
        ( \
        HBOOST_PP_IIF \
            ( \
            HBOOST_VMD_IS_NUMBER(HBOOST_PP_TUPLE_ELEM(0,tuple)), \
            HBOOST_VMD_DETAIL_IS_ARRAY_CHECK_NUMERIC, \
            HBOOST_VMD_IDENTITY(0) \
            ) \
        (tuple) \
        ) \
/**/

#define HBOOST_VMD_DETAIL_IS_ARRAY_CHECK_NUMBER_D(d,tuple) \
    HBOOST_VMD_IDENTITY_RESULT \
        ( \
        HBOOST_PP_IIF \
            ( \
            HBOOST_VMD_IS_NUMBER(HBOOST_PP_TUPLE_ELEM(0,tuple)), \
            HBOOST_VMD_DETAIL_IS_ARRAY_CHECK_NUMERIC_D, \
            HBOOST_VMD_IDENTITY(0) \
            ) \
        (d,tuple) \
        ) \
/**/

/*

  Check if the second element is a tuple

*/

#define HBOOST_VMD_DETAIL_IS_ARRAY_CHECK_ARRAY_FORM(tuple) \
    HBOOST_VMD_IDENTITY_RESULT \
        ( \
        HBOOST_PP_IIF \
          ( \
          HBOOST_VMD_IS_TUPLE(HBOOST_PP_TUPLE_ELEM(1,tuple)), \
          HBOOST_VMD_DETAIL_IS_ARRAY_CHECK_NUMBER, \
          HBOOST_VMD_IDENTITY(0) \
          ) \
        (tuple) \
        ) \
/**/

#define HBOOST_VMD_DETAIL_IS_ARRAY_CHECK_ARRAY_FORM_D(d,tuple) \
    HBOOST_VMD_IDENTITY_RESULT \
        ( \
        HBOOST_PP_IIF \
          ( \
          HBOOST_VMD_IS_TUPLE(HBOOST_PP_TUPLE_ELEM(1,tuple)), \
          HBOOST_VMD_DETAIL_IS_ARRAY_CHECK_NUMBER_D, \
          HBOOST_VMD_IDENTITY(0) \
          ) \
        (d,tuple) \
        ) \
/**/

#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM(x) HBOOST_VMD_IS_EMPTY(HBOOST_PP_CAT(HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_, x) HBOOST_PP_EMPTY())
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_0
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_1
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_2
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_3
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_4
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_5
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_6
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_7
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_8
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_9
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_10
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_11
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_12
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_13
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_14
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_15
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_16
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_17
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_18
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_19
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_20
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_21
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_22
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_23
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_24
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_25
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_26
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_27
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_28
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_29
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_30
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_31
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_32
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_33
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_34
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_35
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_36
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_37
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_38
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_39
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_40
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_41
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_42
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_43
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_44
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_45
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_46
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_47
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_48
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_49
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_50
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_51
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_52
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_53
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_54
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_55
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_56
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_57
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_58
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_59
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_60
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_61
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_62
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_63
#define HBOOST_VMD_DETAIL_IS_ARRAY_NUM_HELPER_64

#endif /* HBOOST_VMD_DETAIL_IS_ARRAY_COMMON_HPP */
